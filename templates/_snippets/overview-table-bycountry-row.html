{% macro inforow(dataset, record, type) -%}
<tr{% if type == 'submissions' %} class="queued"{% endif %}>
  <td>
    {% if type == 'submissions' %}
      &#8627; Awaiting review
    {% else %}
      {{ dataset.title }} &nbsp; <a data-toggle="tooltip" data-trigger="click" class="count-0" title="{{ dataset.description }}"><i class="icon-info-sign"></i></a> 
    {% endif %}
  </td>
  <td{% if record %} data-place="{{ record.place }}" data-dataset="{{ record.dataset }}" data-datasetTitle="{{ dataset.title }}"{% endif %}>
    <ul class="availability icons">
      {% for field in record_fields %}
        {% set state = record[field.id] %}
        <a data-toggle="tooltip" title="{{ field.label }}">
        <li class="{% if state == 'Yes' %}yes{% elif state == 'No' %}no{% elif state == 'Unsure' %}maybe{% endif %}">
          <i class="icon-{{ field.icon }}"></i>
          <span class="text">{{ state }}</span>
        </li>
        </a>
      {% endfor %}
    </ul>
  </td>
  <td>
    {% if record and record.url %}
      <a href="{{record.url}}" title="{{record.url}}" target="_blank"><i class="icon-link"></i></a>
    {% else %}
      <a data-toggle="tooltip" data-trigger="hover" title="No URL given">
            <i class="icon-link icons-nodata"></i>
          </a>
    {% endif %}
  </td>
  <td>
    <ul class="icons">
      <li>
        {% if record and record.dateavailable %}
          <a title="Date available: {{ record.dateavailable }}" data-toggle="tooltip"><i class="icon-calendar"></i></a>
        {% else %}
          <a data-toggle="tooltip" data-trigger="hover" title="No date available given">
            <i class="icon-calendar icons-nodata"></i>
          </a>
        {% endif %}
      </li>
      <li>
        {% if record and record.format %}
          <a title="Data format: {{ record.format }}" data-toggle="tooltip"><i class="icon-file"></i></a>
        {% else %}
          <a data-toggle="tooltip" data-trigger="hover" title="No data format given">
            <i class="icon-file icons-nodata"></i>
          </a>
        {% endif %}
      </li>
      <li>
        {% if record and record.details %}
          <a data-toggle="tooltip" data-html="true" data-trigger="click" class="count-0" title="{{ record.details | replace ('\"', '\'') | urlize | wordwrap(100, '\n', true) }}">
            <i class="icon-info-sign"></i>
          </a>
        {% else %}
          <a data-toggle="tooltip" data-trigger="hover" title="No details">
            <i class="icon-info-sign icons-nodata"></i>
          </a>
        {% endif %}
      </li>
      {% if type == 'submissions' %}
      <li>
        {% if record and record.submitter %}
          {% if record.submitterurl %}
            {% set appendtext = record.submitterurl | replace ('\"', '\'') | urlize | wordwrap(100, '\n', true) %}
          {% else %}
            {% set appendtext = '' %}
          <a data-toggle="tooltip" data-trigger="click" data-html="true" class="count-0" title="{{ record.submitter }} ({{ appendtext }})">
            <i class="icon-user"></i>
          </a>
          {% endif %}
        {% else %}
          <a data-toggle="tooltip" data-trigger="hover" title="No submitter details">
            <i class="icon-user icons-nodata"></i>
          </a>
        {% endif %}
      </li>
      {% endif %}
    </ul>
  </td>
  <td>
    
    {% if type == 'info' %}
      {% if record %} 
        <a id="submit-{{ dataset.id }}" href="/country/submit/?dataset={{ dataset.id }}&place={{ place }}" class="btn btn-mini btn-primary">
          <!-- <i class="icon-plus"></i> -->Propose Revisions
        </a>
      {% else %} 
        <a id="submit-{{ dataset.id }}" href="/country/submit/?dataset={{ dataset.id }}&place={{ place }}" class="btn btn-mini btn-primary">
          <!-- <i class="icon-plus"></i> -->Submit information
        </a>
      {% endif %}
    {% elif type == 'submissions' %}
       <a href="/country/review/{{record.submissionid}}" class="btn btn-mini btn-danger">
        Review Now
       </a>
       <script>
        $("#submit-{{ dataset.id }}").addClass("disabled");
        $("#submit-{{ dataset.id }}").attr("data-toggle", "tooltip");
        $("#submit-{{ dataset.id }}").attr("title", "Sorry, only one submission can be waiting for review at a time - please come back in a few days to submit new information");
       </script>
    {% endif %}
  </td>
</tr>
{%- endmacro %}
