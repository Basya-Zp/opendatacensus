{% macro currentEntry(qu) %}
<div class="current-entry">
    <label>{{gettext("Current Entry")}}</label>
    <div class="current-entry-value">
        {% if currrecord %}
        {% if currrecord[qu.id] %}
        {{currrecord[qu.id]}}
        {% else %}
        {{ gettext("No entry") }}
        {% endif %}
        {% else %}
        {{ gettext("No entry") }}
        {% endif %}
    </div>
</div>
{%- endmacro  %}


{% macro question(qu) -%}
<div class="span6">
    <h4>{{qu.question}}</h4>
    <input type="{{qu.type}}" title="{{qu.placeholder}}" name="{{qu.id}}" value="{{prefill[qu.id]}}" {% if canReview != true %}disabled="disabled"{% endif %} placeholder="{{qu.placeholder}}" {% if qu.id=='format' %} list="formats" {% endif %} />
</div>
<div class="span6">
    {{ currentEntry(qu) }}
</div>
<div class="span12">
    <span class="help-block">{{qu.description}}</span>
</div>
{%- endmacro  %}


<fieldset>

    <div class="row-fluid submission-row head">
        <div class="span12">
            <div class="submission-question">Question</div>
            <div class="submission-option">{{gettext("Yes")}}</div>
            <div class="submission-option">{{gettext("No")}}</div>
            <div class="submission-option">{{gettext("Unsure")}}</div>
            <div class="submission-current">{{gettext("Current Entry")}}</div>
            <div class="submission-info">{{gettext("Information")}}</div>
        </div>
    </div>

    <div class="yntable">
        {% for qu in ynquestions %}
        <div class="row-fluid submission-row{% if loop.index0 != 0 %} hide js-dependent{% endif %}">
            <div class="span12">
                <div class="submission-question">{{ qu.question }}?</div>
                {% for val in ['Yes', 'No', 'Unsure'] %}
                <div class="submission-option">
                    <input type="radio" name="{{qu.id}}" value="{{val}}"
                           class="{{ val }}"
                           {% if canReview != true %} disabled="disabled"{% endif %}
                           {% if prefill[qu.id] == val %}checked="true"{% endif %}
                           required>
                </div>
                {% endfor %}
                <div class="submission-current">
                   {{ currrecord[qu.id] or 'No entry' }}
                </div>
                <div class="submission-info">
                    <span class="help-block readmore">{{qu.description|marked}}</span>
                </div>
                {% for dependant in qu.dependants %}
                <div class="row-fluid submission-dependant">
                    {{ question(dependant) }}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}

    </div>

</fieldset>

<fieldset>
    <div class="row-fluid">
        <hr />
        <h4>{{questionsById.details.question}}</h4>
        <span class="help-block">{{questionsById.details.description|marked}}</span>
        <div id="markdown-preview-container">
        <textarea id="details" name="details" class="span12" {% if canReview != true %}disabled="disabled"{% endif %} style="min-height: 150px;">{{prefill.details}}</textarea>
        <a id="toggle-markdown-preview">
            {{gettext("Show Markdown Preview")}}
        </a>
        <div id="markdown-preview"></div>
        </div>
        {{ currentEntry(questionsById.details) }}
    </div>
</fieldset>

<fieldset class="data-details">
    <datalist id="formats">
        <option value="CSV">
        <option value="Excel">
        <option value="HTML">
        <option value="PDF">
        <option value="json">
        <option value="geojson">
        <option value="shapefiles">
    </datalist>
</fieldset>